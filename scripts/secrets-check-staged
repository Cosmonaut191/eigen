#!/usr/bin/env yarn zx


// This script runs to make sure staged files don't contain secrets.


import {startSpinner} from 'zx/experimental'


const stagedFiles = (await $`git diff --staged --name-only`).stdout
const stagedFilesList = stagedFiles.split("\n")
stagedFilesList.pop() // remove last empty line

const stop = startSpinner()
await $`detect-secrets-hook --baseline .secrets.baseline --verbose ${stagedFilesList}`
stop()
